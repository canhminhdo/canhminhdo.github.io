<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="google-site-verification=XEvx9RQvw6i44_kFVItRw5ppBx8S1umQBkRx9hKTAOA"> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>[Sorting series] Thuật toán sắp xếp Insertion Sort | Canh Minh Do</title> <meta name="author" content="Canh Minh Do"> <meta name="description" content="Computer Science, Software Engineering, Formal Methods. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/bio-photo.png"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://canhminhdo.github.io/blog/2020/sorting-series-thuat-toan-sap-xep-insertion-sort/"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Canh </span>Minh Do</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/profile/">Profile</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching</a> </li> <li class="nav-item "> <a class="nav-link" href="/research/">Research</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/news/">News</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">[Sorting series] Thuật toán sắp xếp Insertion Sort</h1> <p class="post-meta">May 31, 2020</p> <p class="post-tags"> <a href="/blog/2020"> <i class="fas fa-calendar fa-sm"></i> 2020 </a>   ·   <a href="/blog/tag/c"> <i class="fas fa-hashtag fa-sm"></i> C++</a>     ·   <a href="/blog/category/programming"> <i class="fas fa-tag fa-sm"></i> Programming</a>   <a href="/blog/category/data-structures-and-algorithms"> <i class="fas fa-tag fa-sm"></i> Data Structures and Algorithms</a>   <a href="/blog/category/sorting-problem"> <i class="fas fa-tag fa-sm"></i> Sorting Problem</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>Trong bài viết này, chúng ta cùng tìm hiểu về thuật toán Insertion Sort. Ý tưởng của thuật toán Insertion Sort là tại mỗi bước lặp tìm vị trí để chèn một phần tử vào một dãy đã sắp xếp trước để được một dãy sắp xếp.<br> Xét dãy khoá k[1..n], ta thấy dãy con chỉ gồm một khoá k[1] có thể coi là đã sắp xếp.<br> Xét thêm k[2], ta so sánh k[2] với k[1], nếu k[2] &lt; k[1] thì ta chèn k[2] vào trước k[1].<br> Đối với k[3], ta xét dãy chỉ gồm 2 khoá k[1], k[2] đã sắp xếp và tìm cách chèn k[3] vào dãy để được dãy sắp xếp.<br> …<br> Tổng quát, ta sẽ có dãy <strong>k[1..i]</strong> trong đó <strong>k[1..i - 1]</strong> đã sắp xếp, ta cần tìm cách chèn <strong>k[i]</strong> vào đúng vị trí để được dãy <strong>k[1..i]</strong> sắp xếp.<br></p> <figure class="highlight"><pre><code class="language-pseudocode" data-lang="pseudocode">void function InsertionSort() {
    int j, tmp;
    for (int i = 1; i &lt; n; i ++) {
        // chèn giá trị k[i] vào dãy k[0..i-1] để được dãy k[0..i] đã sắp xếp
        tmp = k[i]; // lưu lại giá trị k[i]
        j = i - 1;
        while (i &gt;= 0 &amp; k[j] &lt; tmp) {
            k[j + 1] = k[j]; // dịch giá trị k[j] lùi về sau một vị trí
            j = j - 1;
        }
        k[j + 1] = tmp; // đưa giá trị k[i] chèn vào khoảng trống mới
    }
}</code></pre></figure> <p>Thuật toán Insertion Sort có phụ thuộc vào dãy khoá ban đầu, nếu dãy khoá đã sắp xếp thì ta chỉ mất thời gian O(n) để chạy thực hiện. Trong trường hợp xấu nhất ta vẫn mất \(O(n^2)\). Chúng ta có thể cải thiện thuật toán tại bước chèn phần tử <strong>k[i]</strong> vào mảng <strong>k[0..i - 1]</strong> bưởi vì mảng đã được sắp xếp trước đó. Vì vậy chúng ta có thể dùng tìm kiếm nhị phân để nhanh chóng tìm ra vị trí cần chèn vào mảng. Nhưng trong trường hợp xấu nhất ta vẫn phải dịch <strong>i - 1</strong> về phía sau một bước để tạo ra khoangr trống cho <strong>k[i]</strong>. Vì vậy điều đó cũng không làm giảm đi độ phức tạp của thuật toán.</p> <p>Dưới đây là cách cài đặt thuật toán Insertion Sort và cải tiến khi dùng kỹ thuật tìm kiếm nhị phân.</p> <figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">arr</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">};</span>
<span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">insertionSort</span><span class="p">();</span>
<span class="kt">void</span> <span class="nf">insertionSortWithBinarySearch</span><span class="p">();</span>
<span class="kt">void</span> <span class="nf">shift</span><span class="p">(</span><span class="kt">int</span> <span class="n">idxStart</span><span class="p">,</span> <span class="kt">int</span> <span class="n">i</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">print</span><span class="p">();</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">insertionSort</span><span class="p">();</span>
    <span class="n">insertionSortWithBinarySearch</span><span class="p">();</span>
    <span class="n">print</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">insertionSort</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">tmp</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">j</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// chèn giá trị arr[i] vào dãy arr[0..i-1] để toàn dãy arr[0..i] trở thành sắp xếp</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="c1">// lưu lại giá trị arr[i]</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">tmp</span> <span class="o">&lt;</span> <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="p">{</span>
            <span class="n">arr</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="p">];</span> <span class="c1">// dịch giá trị arr[j] về sau một vị trí, tạo một khoảng trống j</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">arr</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span> <span class="c1">// đưa giá trị chèn vào khoảng chống mới tạo ra</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">insertionSortWithBinarySearch</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">idxStart</span><span class="p">,</span> <span class="n">idxStop</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">tmp</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="c1">// binary search</span>
        <span class="n">idxStart</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">idxStop</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
        <span class="c1">// idxStart chính là vị trí cần chèn sau khi thoát khỏi vòng lặp</span>
        <span class="c1">// mỗi lượt lặp sẽ co ngắn đoạn cần kiểm tra</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="n">median</span> <span class="o">=</span> <span class="p">(</span><span class="n">idxStart</span> <span class="o">+</span> <span class="n">idxStop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">median</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">{</span>
                <span class="n">idxStop</span> <span class="o">=</span> <span class="n">median</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">idxStart</span> <span class="o">=</span> <span class="n">median</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">while</span><span class="p">(</span><span class="n">idxStart</span> <span class="o">&lt;=</span> <span class="n">idxStop</span><span class="p">);</span>
        <span class="c1">// dịch khoá từ arr[idxStart] tới arr[i - 1] lùi sau một vị trí</span>
        <span class="n">shift</span><span class="p">(</span><span class="n">idxStart</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
        <span class="n">arr</span><span class="p">[</span><span class="n">idxStart</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span> <span class="c1">// đưa giá trị tmp vào khoảng trống</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">shift</span><span class="p">(</span><span class="kt">int</span> <span class="n">idxStart</span><span class="p">,</span> <span class="kt">int</span> <span class="n">j</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;=</span> <span class="n">idxStart</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">arr</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">print</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">'\t'</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure> <p>Kết quả khi chạy chương trình trên sẽ như sau:</p> <figure class="highlight"><pre><code class="language-pseudocode" data-lang="pseudocode">1	2	3	4	5</code></pre></figure> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/C++-static-library-va-dynamic-library/">C++ static library và dynamic library</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/nhung-luu-y-khi-viet-code-de-chuong-trinh-tro-len-sang-sua-va-mach-lac/">Những lưu ý khi viết code để chương trình trở lên sáng sủa và mạch lạc</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/ban-that-su-da-biet-ve-bit-shifting/">Bạn thật sự đã biết về Bit shifting</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/hash-tables/">Hash tables</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/cach-bieu-dien-so-am-trong-trong-may-tinh/">Cách biểu diễn số âm trong máy tính</a> </li> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0 text-center"> © Copyright 2023 Canh Minh Do. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-163449648-1"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-163449648-1");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>