<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="google652b6e851dbdf40b.html"> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Tìm hiểu về định lý Bayes và ứng dụng | Canh Minh Do</title> <meta name="author" content="Canh Minh Do"> <meta name="description" content="Computer Science, Software Engineering, Formal Methods. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/bio-photo.png"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://canhminhdo.github.io/blog/2020/tim-hieu-dinh-ly-bayes-va-ung-dung/"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Canh </span>Minh Do</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/profile/">Profile</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching</a> </li> <li class="nav-item "> <a class="nav-link" href="/research/">Research</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/news/">News</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Tìm hiểu về định lý Bayes và ứng dụng</h1> <p class="post-meta">June 30, 2020</p> <p class="post-tags"> <a href="/blog/2020"> <i class="fas fa-calendar fa-sm"></i> 2020 </a>   ·   <a href="/blog/tag/classifier"> <i class="fas fa-hashtag fa-sm"></i> Classifier</a>   <a href="/blog/tag/bayes"> <i class="fas fa-hashtag fa-sm"></i> Bayes</a>     ·   <a href="/blog/category/machine-learning"> <i class="fas fa-tag fa-sm"></i> Machine learning</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>Định lý Bayes là một định lý toán học để tính xác suất xảy ra của một sự kiện ngẫu nhiên <strong>A</strong> khi biết sự kiện liên quan <strong>B</strong> đã xảy ra.</p> <p><strong>1. Xác suất có điều kiện</strong></p> <p>Ta có 2 sự kiện ngẫu nhiên A và B, nếu A và B là hai sự kiện liên quan tới nhau:</p> <center>$$P(A,B) = P(A|B) P(B)$$ or $$P(A,B) = P(B|A) P(A)$$</center> <p>Nếu hai sự kiện A và B là độc lập với nhau thì công thức trên sẽ trở thành:</p> <center>$$P(A,B) = P(A) P(B)$$</center> <p><strong>2. Định lý Bayes</strong></p> <p>Định lý Bayes dựa trên định nghĩa về xác suất có điều kiện ở trên, được phát biểu dưới dạng công thức sau:</p> <center>$$P(A|B) = \frac{P(A) P(B|A)}{P(B)}$$</center> <p><strong>P(A)</strong> - được gọi là xác suất tiền nghiệm (prior probability) khi chưa nhìn thấy B<br> <strong>P(B|A)</strong> - được gọi là likelihood, xác suất có điều kiện (conditional probability) khi nhìn thấy A<br> <strong>P(A|B)</strong> - được gọi là xác suất hậu nghiệp (posterior probability) khi nhìn thấy B<br> <strong>P(B)</strong> - được gọi là predictor Prior Probability hoặc evidence (tiếng việt nên gọi là gì)<br></p> <p><strong>3. Naive Bayes</strong></p> <p>Áp dụng công thức Bayes ở trên ta có như sau</p> <center>$$P(y|X) = \frac{P(y) P(X|y)}{P(X)}$$</center> <p>Cho \(X = (x_1, x_2, ..., x_n)\) thay thế vào công thức trên ta có</p> <center>$$P(y|x_1,...,x_n) = \frac{P(y) P(x_1,..,x_n|y)}{P(x_1,...,x_n)}$$</center> <p>Dựa vào xác suất có điều kiện chúng ta có thể khai triển như sau</p> <center>$$P(x_1,...,x_n|y) = P(x_1|y,x_2,...,x_n)P(x_2,...,x_n|y)$$</center> <center>$$P(x_1,...,x_n) = P(x_1|x_2,...,x_n)P(x_2,...,x_n)$$</center> <p>Naive Bayes cho chúng ta một giả thuyết rằng tất cả các biến ngẫu nhiên \(x_i\) là độc lập với nhau. Vì vậy ta có thể suy ra như sau:</p> <center>$$P(x_1|y, x_2,...,x_n) = P(x_1|y)$$</center> <center>$$P(x_1|x_2,...,x_n) = P(x_1)$$</center> <p>Công thức ban đầu sẽ trở thành</p> <center>$$P(y|x_1,...,x_n) = \frac{P(y) \prod^n_{i=1}P(x_i|y)}{P(x_1)...P(x_n)}$$</center> <p>Để ước lượng xác suất của tất cả giá trị y với đầu vào X, ta có thể thấy rằng \(P(X) = P(x_1)...P(x_n)\) là một hằng số. Vì vậy, để tìm được sắc suất lớn nhất của giá trị y với đầu vào X ta có công thức sau.</p> <center>$$P(y|x_1,...,x_n) \propto P(y) \prod^n_{i=1}P(x_i|y)$$</center> <center>$$\hat{y} = \underset{y}{argmax}(P(y) \prod^n_{i=1}P(x_i|y))$$</center> <p><strong>Chú ý:</strong> \(\propto\) là phép tính tỷ lệ (proportion)</p> <p><strong>4. Áp dụng vào bài toán sau</strong></p> <p>Ta có một tập training set như sau:</p> <table> <thead> <tr> <th> </th> <th>Doc</th> <th>Words</th> <th>Class</th> </tr> </thead> <tbody> <tr> <td>Training</td> <td>1</td> <td>fish smoked fish</td> <td>f</td> </tr> <tr> <td> </td> <td>2</td> <td>fish line</td> <td>f</td> </tr> <tr> <td> </td> <td>3</td> <td>fish haul smoked</td> <td>f</td> </tr> <tr> <td> </td> <td>4</td> <td>guitar jazz line</td> <td>g</td> </tr> <tr> <td>Test</td> <td>5</td> <td>line guitar jazz jazz</td> <td>?</td> </tr> <tr> <td> </td> <td> </td> <td>V = {fish, smoked, line, haul, guitar, jazz}</td> <td> </td> </tr> </tbody> </table> <p>Đưa vào một dữ liệu <strong>line guitar jazz jazz</strong> hỏi rằng nó thuộc lớp <strong>f</strong> hay lớp <strong>g</strong>. Chúng ta có thể áp dụng Naive Bayes để tính xác suất dữ liệu đưa vào thuộc lớp <strong>f</strong> hay lớp <strong>g</strong> như sau.</p> \[P(f|line, guitar, jazz, jazz) = p(line|f) P(guitar|f) P(jazz|f) P(jazz|f) P(f)\] \[P(g|line, guitar, jazz, jazz) = p(line|g) P(guitar|g) P(jazz|g) P(jazz|f) P(g)\] <p>Xác suất tiền nghiệm được tính như sau (Priors):</p> \[P(c) = \frac{N_c}{N}\] <p>Có thể hiểu là tổng số class \(c\) trên tổng toàn bộ các classs. Ta sẽ có kết quả là \(P(f) = 3/4\) và \(P(g) = 1/4\).</p> <p>Xác suất có điều kiện được tính như sau (Conditional Probabilities):</p> \[P(w|c) = \frac{count(w,c) + \alpha}{count(c) + \alpha * |V|}\] <p>Cho vào một từ \(w\), chúng ta đếm số lượng từ \(w\) xuất hiện trong lớp \(c\). Chia cho tổng số lượng từ thuộc vào lớp \(c\). Ngoài ra chúng ta sử dụng kỹ thuật <strong>Laplace Smoothing</strong> với \(\alpha = 1\) để tránh trường hợp \(P(w|c) = 0\) bằng cách cộng 1 vào tử và cộng số lượng từ trong từ điển vào mẫu. Nó sẽ không ảnh hưởng tới kết quả cuối cùng. Ngoài ra bạn có thể sử dụng hàm \(log\) để tránh gặp phải giá trị xác suất bằng 0.</p> \[P(line|f) = (1+1)/(8+6) = 2/14\] \[P(guitar|f) = (0+1)/(8+6) = 1/14\] \[P(jazz|f) = (0+1)/(8+6) = 1/14\] \[P(line|g) = (1+1)/(3+6) = 2/9\] \[P(guitar|g) = (1+1)/(3+6) = 2/9\] \[P(guitar|g) = (1+1)/(3+6) = 2/9\] <p>Thay thế giá trị đã tính toán vào công thức ban đầu ta sẽ có kết quả sau</p> \[P(f|line, guitar, jazz, jazz) = 2/14 * 1/14 * 1/14 * 1/4 * 3/4 \approx 0.00003\] \[P(g|line, guitar, jazz, jazz) = 2/9 * 2/9 * 2/9 * 2/9 * 1/4 \approx 0.0006\] <p>Dựa vào kết quả tính toán với Naive Bayes, chúng ta có thể dự toán dữ liệu đưa vào <strong>line guitar jazz jazz</strong> thuộc vào lớp <strong>g</strong> với xác xuất cao hơn.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/lvalues-and-rvalues-in-c++/">Lvalues and Rvalues in C++</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/C++-static-library-va-dynamic-library/">C++ static library và dynamic library</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/nhung-luu-y-khi-viet-code-de-chuong-trinh-tro-len-sang-sua-va-mach-lac/">Những lưu ý khi viết code để chương trình trở lên sáng sủa và mạch lạc</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/ban-that-su-da-biet-ve-bit-shifting/">Bạn thật sự đã biết về Bit shifting</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/hash-tables/">Hash tables</a> </li> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0 text-center"> © Copyright 2024 Canh Minh Do. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-163449648-1"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-163449648-1");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>